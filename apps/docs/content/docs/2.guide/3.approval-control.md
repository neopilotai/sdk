---
title: Control Write Safety
description: Gate dangerous operations with human approval policies.
path: /guide/approval-control
links:
  - label: Configure token scopes
    icon: i-lucide-key-round
    to: /guide/token-permissions
    color: neutral
    variant: subtle
  - label: See examples
    icon: i-lucide-code
    to: /guide/examples
    color: neutral
    variant: subtle
---

Write operations like merging a PR or closing an issue can have irreversible consequences. The SDK provides an approval layer that intercepts mutations before they execute.

## Require approval for all writes

By default, every write operation requires explicit approval. You don't need to pass any extra option:

```ts [default-approval.ts]
import { createRepoLens } from '@repolens-ai/sdk'

const tools = createRepoLens({
  })

```

## Disable approval in trusted environments

In CI pipelines or automated workflows where human review happens elsewhere (e.g. PR-based), you can disable approval entirely:

```ts [ci-pipeline.ts]
import { createRepoLens } from '@repolens-ai/sdk'

const tools = createRepoLens({
  requireApproval: false,
})
```

## Configure approval per operation

For nuanced policies, enable approval selectively. This example approves destructive actions but allows comments freely:

```ts [selective-approval.ts]
import { createRepoLens } from '@repolens-ai/sdk'

const tools = createRepoLens({
  requireApproval: {
    mergePullRequest: true,
    createOrUpdateFile: true,
    closeIssue: true,
    createPullRequest: false,
    addPullRequestComment: false,
    createIssue: false,
    addIssueComment: false,
  },
})
```

## Assess risk by operation

| Operation | Risk | Suggested policy |
|---|---|---|
| `createOrUpdateFile` | High | Always require approval |
| `mergePullRequest` | High | Always require approval |
| `closeIssue` | Medium | Require in production repos |
| `createPullRequest` | Medium | Optional in trusted CI |
| `addPullRequestComment` | Low | Usually skip |
| `addIssueComment` | Low | Usually skip |

::warning
Approval is one safety layer, not the only one. Combine it with least-privilege [token scopes](/guide/token-permissions) and narrow [presets](/guide/presets).
::

## External references

- [GitHub branch protection rules](https://docs.github.com/en/repositories/configuring-branches-and-merges-in-your-repository/managing-protected-branches)
